# AX-TrafficAnalyzer Kubernetes Service
# Copyright Â© 2025 MMeTech (Macau) Ltd.
#
# Note: With hostNetwork, service is mainly for discovery
# Actual access is via node IP on port 8443
apiVersion: v1
kind: Service
metadata:
  name: ax-traffic-analyzer
  namespace: ax-traffic
  labels:
    app.kubernetes.io/name: ax-traffic-analyzer
    app.kubernetes.io/component: service
spec:
  type: ClusterIP  # Use NodePort or LoadBalancer for external access
  selector:
    app: ax-traffic-analyzer
  ports:
    - name: https
      port: 8443
      targetPort: 8443
      protocol: TCP
    - name: metrics
      port: 9090
      targetPort: 9090
      protocol: TCP
---
# NodePort Service for external access (alternative)
apiVersion: v1
kind: Service
metadata:
  name: ax-traffic-analyzer-nodeport
  namespace: ax-traffic
  labels:
    app.kubernetes.io/name: ax-traffic-analyzer
    app.kubernetes.io/component: service-external
spec:
  type: NodePort
  selector:
    app: ax-traffic-analyzer
  ports:
    - name: https
      port: 8443
      targetPort: 8443
      nodePort: 30443  # Access via <node-ip>:30443
      protocol: TCP

